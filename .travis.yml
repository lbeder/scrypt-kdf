language: rust
rust:
  - stable
  - nightly
cache: cargo
before_script:
  - |
      if [[ "$TRAVIS_RUST_VERSION" == "nightly" ]]; then
        rustup component add clippy --toolchain nightly-x86_64-unknown-linux-gnu
      else
        rustup component add clippy
      fi
script:
  - cargo clippy --all-targets --all-features -- -D warnings
  - cargo test --release
